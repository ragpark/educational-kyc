{% extends "base.html" %}
{% block title %}Verify Credential{% endblock %}
{% block content %}
<div class="max-w-3xl mx-auto">
    <h2 class="text-2xl font-bold text-gray-900 mb-4">Verify Credential</h2>
    <form method="POST" action="/verify-credential" class="bg-white rounded-lg shadow-md p-6 space-y-4">
        <div>
            <label for="credential_json" class="block text-sm font-medium text-gray-700 mb-1">Credential JSON</label>
            <textarea id="credential_json" name="credential_json" rows="8" required class="w-full border border-gray-300 rounded-md p-2">{{ credential_json or '' }}</textarea>
        </div>
        <div>
            <label for="expected_subject" class="block text-sm font-medium text-gray-700 mb-1">Expected Subject ID (optional)</label>
            <input type="text" id="expected_subject" name="expected_subject" value="{{ expected_subject or '' }}" class="w-full border border-gray-300 rounded-md p-2" placeholder="urn:uuid:...">
        </div>
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-md">Verify</button>
    </form>

    {% if error %}
    <div class="mt-4 text-red-600">{{ error }}</div>
    {% endif %}

    {% if result %}
    <div class="mt-6 bg-gray-50 p-4 rounded-lg">
        <h3 class="text-lg font-semibold text-gray-800 mb-2">Verification Result</h3>
        <ul class="space-y-1 text-sm text-gray-700">
            <li>Issuer trusted: {{ '✓' if result.issuer_trusted else '✗' }}</li>
            <li>Key valid: {{ '✓' if result.key_valid else '✗' }}</li>
            <li>Trust registry: {{ '✓' if result.trust_registry_ok else '✗' }}</li>
            <li>Not expired: {{ '✓' if result.not_expired else '✗' }}</li>
            <li>Not revoked: {{ '✓' if result.not_revoked else '✗' }}</li>
            <li>Subject matches: {{ '✓' if result.subject_match else '✗' }}</li>
        </ul>
        <p class="mt-2 font-bold">Overall: {{ 'Valid' if result.is_valid else 'Invalid' }}</p>
    </div>
    {% endif %}
</div>
{% endblock %}
